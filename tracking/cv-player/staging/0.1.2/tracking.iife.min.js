!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;((e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).vtg||(e.vtg={})).tracking=t()}}(function(){return function a(r,s,d){function h(e,t){if(!s[e]){if(!r[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var o=s[e]={exports:{}};r[e][0].call(o.exports,function(t){return h(r[e][1][t]||t)},o,o.exports,a,r,s,d)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<d.length;t++)h(d[t]);return h}({1:[function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(r=(a<3?o(r):3<a?o(e,n,r):o(e,n))||r);return 3<a&&r&&Object.defineProperty(e,n,r),r};function r(n){return function(t,e){t.keys||(t.keys={}),t.keys[e]=function(t){return t.hasOwnProperty(e)&&t[e]?t[e]:"boolean"!=typeof n?n||"":n}}}Object.defineProperty(n,"__esModule",{value:!0}),n.ModuleParam=r;var s=function(){function t(t){this.data=t,this.format()}return t.prototype.format=function(){var e=this,n=this;return Object.keys(this.keys).forEach(function(t){n[t]=e.keys[t](e.data)}),n},t}();function h(){return function(t){t.prototype.destroy=function(){var e=this;"function"==typeof this.onBeforeDestroy&&this.onBeforeDestroy(),Object.keys(this).forEach(function(t){"function"!=typeof e[t]&&(e[t]=null)})}}}function d(e){return function(t){t.prototype.injectable=e}}n.DataAccess=s,n.Destroyable=h,n.Injectable=d;var c=function(){function t(){}return t.ERROR="error",t.LOADED="loaded",t}();n.JsInjector=c;var u=function(){function t(){this.debug=!1,console&&this.setLogger(console)}return t.getDefault=function(){return this.instance||(this.instance=new this)},t.prototype.setLogger=function(t){this.hasLog(t)&&(this.logger=t)},t.prototype.hasLog=function(t){return"object"==typeof t&&"function"==typeof t.log},t}();n.Log=u;var p=function(){function t(){this.observers=[]}return t.prototype.register=function(t){"object"==typeof t&&(this.observers.unshift(t),t.onRegister())},t.prototype.deregister=function(e){this.observers=this.observers.filter(function(t){return t!==e})},t.prototype.notify=function(t){for(var e=this.observers.length;e--;){var n=this.observers[e];n.onNotify.call(n,t)}},t}();n.Observable=p;var l=function(){function t(){this.items=[],this.isRunning=!1}return t.prototype.add=function(t){this.items.unshift(t)},t.prototype.forEach=function(t){if(!this.isRunning){this.isRunning=!0;for(var e=this.items.length;e--;){var n=this.items.pop();n&&t(n)}this.isRunning=!1}},t.prototype.isEmpty=function(){return 0===this.items.length},t}();n.Queue=l;var g=function(){function t(t){this.baseUrl=t,this.baseUrl=t.replace(/^\w*:/,"").replace(/^\/\//,"").replace(/\/*$/,"")}return t.prototype.request=function(t){return this.options=t,this},t.prototype.then=function(t){switch(this.options.method){case"POST":this.post(t);break;case"GET":this.get(t)}},t.prototype.post=function(t){if(XMLHttpRequest){var e=new XMLHttpRequest,n=[this.baseUrl,this.options.path].join("/");e.open("POST","//"+n,!0),e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&t({xmlHttpRequest:e,statusCode:e.status,message:200<=e.status&&e.status<300||304===e.status?"ok":e.statusText})},e.onerror=function(){t({xmlHttpRequest:e,statusCode:e.status,message:"error"})},e.send(JSON.stringify(this.options.data))}else this.xhrNotFound(t)},t.prototype.get=function(n){if(XMLHttpRequest){var t=new XMLHttpRequest,e=[this.baseUrl,this.options.path].join("/"),i=function(t,e){n({xmlHttpRequest:t,statusCode:t.status,message:e})};t.open("GET","//"+e,!0),t.onload=function(){return i(t,"load")},t.onerror=function(){return i(t,"error")},t.onabort=function(){return i(t,"abort")},t.send(e+JSON.stringify(this.options.data))}else this.xhrNotFound(n)},t.prototype.xhrNotFound=function(t){t({xmlHttpRequest:null,statusCode:-1,message:"XHR not supported"})},t}();n.RestClient=g;var f,y=function(){function t(t){this.milliseconds=t,this.isRunning=!1}return t.prototype.start=function(t){setInterval&&(this.isRunning||(this.intervalId=setInterval(t,this.milliseconds),this.isRunning=!0))},t.prototype.stop=function(){clearInterval&&(clearInterval(this.intervalId),this.isRunning=!1)},t}();n.Timer=y,function(t){function i(){return"object"==typeof window}function e(){return"object"==typeof top}function n(){return e()&&-1<top.location.href.search(/^https/)}t.isWindow=i,t.isTop=e,t.isVar=function(t,e){var n=t.split(".");return 2===n.length?i()&&typeof window[n[0]]===e&&typeof window[n[0]][n[1]]===e:i()&&typeof window[t]===e},t.getVar=function(t){return i()&&window[t]},t.getScreenSize=function(){var t=window;return i()&&t.screen&&t.screen.width&&t.screen.height?t.screen.width+"x"+t.screen.height:"N/A"},t.isHttps=n,t.getProtocol=function(){return e()?n()?"https://":"http://":""}}(f=n.View||(n.View={}));var v=function(){function t(){this.vo=new m}return t.prototype.update=function(t){this.vo=this.mergeData(t),this.vo.timestamp=(new Date).getTime()},t.prototype.getData=function(){return this.vo},t.prototype.mergeData=function(t){var e=this.vo;for(var n in t)t.hasOwnProperty(n)&&t[n]&&(e[n]=t[n]);return e},t}();n.DataVoProxy=v;var m=function(){this.playerName="",this.playerVersion="",this.playerInitTime=-1,this.playerManager={},this.dashJsPlayer={},this.hlsJsPlayer={},this.videoElement={},this.isMobile=!1,this.hasSessionResumed=!1,this.sessionId="",this.adBreakType="",this.adBreakPosition=-1,this.adBreakDuration=-1,this.adTitle="",this.adId="",this.adUrl="",this.adDuration=-1,this.adPosition=-1,this.mediaUrl="",this.category="",this.mediaId="",this.episodeTitle="",this.seriesTitle="",this.videoTitle="",this.airDate="",this.duration=-1,this.episodeFlag=!1,this.isLive=!1,this.timestamp=-1,this.playhead=-1,this.season=-1,this.episode=-1,this.liveSegmentData={},this.cdn="",this.currentBitrate=-1,this.playbackFramerate=-1,this.drmEnabled=!1,this.drmType="",this.userId="",this.userStatus="anon",this.partner="",this.userCountry="",this.userConnectionType="",this.contextData={},this.ozTamMediaId="",this.ozTamOptOut=!1,this.nielsenOptOut=!1,this.errorType=-1,this.errorMessage="",this.errorFatal=!1};n.DataVo=m;var S,k,b,E=function(){function t(t,e){this.config=t,this.observable=e,this.notifications=new l,this.isAdPlaying=!1,this.isSdkLoaded=!1,this.debugId="[Tracker] "+t.name}return t.prototype.onRegister=function(){this.isDebug()&&this.logger.log(this.debugId,"start up")},t.prototype.onNotify=function(t){var e=this;this.notifications.add(t),this.hasSdkLoaded()&&this.notifications.forEach(function(t){e.onNotificationReceived(t)})},t.prototype.hasSdkLoaded=function(){if("object"!=typeof this.injectable)return this.isSdkLoaded;var t=this.injectable,e=f.getVar(t.name);return e&&(this[t.name]=e,this.isSdkLoaded=!0),this.isSdkLoaded},t.prototype.onNotificationReceived=function(t){switch(this.isDebug()&&this.logger.log(this.debugId,t),(this.notification=t).name){case S.AdBreakStart:case S.AdStart:this.isAdPlaying=!0;break;case S.AdEnd:case S.AdBreakEnd:case S.ContentStart:this.isAdPlaying=!1}},t.prototype.hasContentCompleted=function(){return this.observable.hasContentCompleted()},t.prototype.getData=function(){return this.observable.getDataVo()},t.prototype.isDebug=function(){return u.getDefault().debug},Object.defineProperty(t.prototype,"logger",{get:function(){return u.getDefault().logger},enumerable:!0,configurable:!0}),t}();n.Agent=E,(k=S=n.AppEvent||(n.AppEvent={})).AppClose="appClose",k.EnterForeground="EnterForeground",k.ExitForeground="ExitForeground",k.AdBreakEnd="adBreakEnd",k.AdBreakStart="adBreakStart",k.AdClick="adClick",k.AdEnd="adEnd",k.AdError="adError",k.AdLoaded="adLoaded",k.AdPause="adPause",k.AdResume="adResume",k.AdSkip="adSkip",k.AdStart="adStart",k.BitrateChange="bitrateChange",k.BufferEnd="bufferEnd",k.BufferStart="bufferStart",k.ContentEnd="contentEnd",k.ContentPause="contentPause",k.ContentResume="contentResume",k.ContentStart="contentStart",k.DashJsLoaded="dashJsLoaded",k.HlsJsLoaded="hlsJsLoaded",k.LiveSegmentStart="LiveSegmentStart",k.LiveSegmentEnd="LiveSegmentEnd",k.PlayerError="playerError",k.SeekEnd="seekEnd",k.SeekStart="seekStart",k.PlayheadUpdate="playheadUpdate",k.SessionEnd="sessionEnd",k.SessionStart="sessionStart",(b=n.BuildInfo||(n.BuildInfo={})).applicationPlatform="Desktop",b.isChromecast=function(){return"Chromecast"===b.applicationPlatform},b.isVizio=function(){return"Vizio"===b.applicationPlatform},b.isPS4=function(){return"PS4"===b.applicationPlatform};var C=function(){function t(){}return t.prototype.registerAgents=function(i){var o=this;this.tracker=i,this.tracker.modules.forEach(function(t){var e=t;if(o.isAgentEnabled(e.NAME)){var n=o.getAgentConfig(e.NAME);o.registerAgent(new e(n,i))}})},t.prototype.isAgentEnabled=function(t){return this.tracker.config.hasOwnProperty(t)&&this.tracker.config[t].hasOwnProperty("enabled")&&this.tracker.config[t].enabled},t.prototype.getAgentConfig=function(t){var e=this.tracker.config[t];return e.name=t,e},t.prototype.registerAgent=function(t){this.tracker.register(t)},t}();n.Registrar=C;var D=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.registrar=new C,t.dataProxy=new v,t.modules=[A,T,R],t.version="tracking v0.1.2 Tue, 04 Jun 2019 18:04:11 GMT",t}return o(t,n),t.prototype.track=function(t,e){this.isDebug()&&this.logger().log("[Tracker] "+t,e),this.dataProxy.update(e),n.prototype.notify.call(this,{name:t,body:e})},t.prototype.setConfig=function(t){this.config=t,this.registrar.registerAgents(this)},t.prototype.setContextData=function(t){this.dataProxy.update({contextData:t})},t.prototype.setLiveSegmentData=function(t){this.dataProxy.update({liveSegmentData:t})},t.prototype.setDebug=function(t){u.getDefault().debug=t},t.prototype.setLogger=function(t){u.getDefault().setLogger(t)},t.prototype.getDataVo=function(){return this.dataProxy.getData()},t.prototype.hasContentCompleted=function(){var t=this.getDataVo();return(!t||!t.isLive)&&t.playhead>=.95*t.duration},t.prototype.isDebug=function(){return u.getDefault().debug},t.prototype.logger=function(){return u.getDefault().logger},t}(p),_=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t.hasResourceReady=!1,t.hasContentStart=!1,t.hasContentPause=!1,t.hasBufferStart=!1,t.hasSeekStart=!1,t.doContentStart=!1,t.eventMap={resourceReady:t.onResourceReady,contentPlaying:t.onPlaying,contentPaused:t.onPause,contentSeeking:t.onSeeking,contentBuffering:t.onBuffering,contentBitrateChanged:t.onBitrateChanged,contentTimeupdate:t.onTimeUpdate,contentEnd:t.onContentEnd,resourceError:t.onResourceError},t}return o(t,i),t.prototype.setModel=function(t){(this.model=t).resource&&t.resource.contextMetadata&&i.prototype.setContextData.call(this,this.model.resource.contextMetadata)},t.prototype.registerUvpc=function(t){this.setConfig(t)},t.prototype.track=function(t,e){this.eventMap[t].call(this,e)},t.prototype.onResourceReady=function(){this.hasResourceReady||(this.hasResourceReady=!0,this.trackEvent(S.SessionStart,{playerName:this.model.collection.BuildInfo.playerName,playerVersion:this.model.collection.BuildInfo.playerVersion,sessionId:"<the-session-id>",hasSessionResumed:!1,userId:"<the-user-id>",partner:"<partner>",userCountry:"<the-two-digit-country-code>",drmEnabled:!1,userConnectionType:"desktop",videoElement:this.model.collection.PlayerDom.video,isMobile:!1}))},t.prototype.onPlaying=function(){this.hasContentStart?this.hasContentPause?(this.hasContentPause=!1,this.trackEvent(S.ContentResume)):this.hasSeekStart&&(this.hasSeekStart=!1,this.trackEvent(S.SeekEnd)):(this.hasContentStart=!0,this.doContentStart=!0)},t.prototype.onPause=function(){this.hasContentStart&&!this.hasContentPause&&(this.hasContentPause=!0,this.trackEvent(S.ContentPause))},t.prototype.onSeeking=function(){this.hasContentStart&&!this.hasSeekStart&&(this.hasSeekStart=!0,this.trackEvent(S.SeekStart))},t.prototype.onBuffering=function(){this.hasContentStart&&!this.hasBufferStart&&(this.hasBufferStart=!0,this.trackEvent(S.BufferStart))},t.prototype.onBitrateChanged=function(){this.hasContentStart&&this.trackEvent(S.BitrateChange,{currentBitrate:this.model.collection.ContentPlaybackState.playbackBitrate})},t.prototype.onTimeUpdate=function(){this.hasContentStart&&this.doContentStart&&(this.trackContentStart(),this.doContentStart=!1),this.hasBufferStart&&(this.hasBufferStart=!1,this.trackEvent(S.BufferEnd)),this.hasContentPause||(this.hasContentStart&&this.trackEvent(S.PlayheadUpdate),this.hasContentStart&&this.hasContentCompleted()&&(this.onContentEnd(),this.trackSessionEnd()))},t.prototype.onContentEnd=function(){this.hasContentStart&&this.trackEvent(S.ContentEnd),this.hasContentStart=!1},t.prototype.onResourceError=function(t){this.trackEvent(S.PlayerError,t)},t.prototype.trackContentStart=function(){var t=this.model.resource;this.trackEvent(S.ContentStart,{mediaUrl:t.resourceLocation.mediaUrl,mediaId:t.contentMetadata.videoTitle,duration:this.model.collection.ContentPlaybackState.duration,videoTitle:t.contentMetadata.videoTitle,seriesTitle:t.contentMetadata.seriesTitle,season:t.contentMetadata.seasonNumber,episode:t.contentMetadata.episodeNumber,category:t.contentMetadata.category,isLive:this.isLive(),episodeFlag:t.contentMetadata.episodeFlag,ozTamMediaId:"",ozTamOptOut:!1})},t.prototype.trackEvent=function(t,e){var n=e||{};n.playhead=this.model.collection.ContentPlaybackState.playheadTime,i.prototype.track.call(this,t,n)},t.prototype.trackSessionEnd=function(){this.hasResourceReady=!1,this.hasContentStart=!1,this.hasContentPause=!1,this.hasBufferStart=!1,this.hasSeekStart=!1,this.doContentStart=!1,this.trackEvent(S.SessionEnd)},t.prototype.isLive=function(){var t=this.model.resource.contentMetadata.streamType;return!(!t||"LIVE"!==t.toLocaleUpperCase())},t}(n.Tracker=D);n.CvTracker=_;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasAdobeSession=!1,t.isStopped=!1,t.isSdkLoaded=!0,t}return o(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.vo=new P(this),this.restClient=new g(this.isDebug()?this.vo.devApiServer:this.vo.prodApiServer),this.eventQueue=new l,this.timer=new y(this.vo.hbInterval)},t.prototype.onNotificationReceived=function(t){switch(e.prototype.onNotificationReceived.call(this,t),t.name){case S.AdBreakStart:this.pauseHbTracking(),this.trackEvent("adBreakStart");break;case S.AdStart:this.trackEvent("adStart");break;case S.AdClick:case S.AdPause:this.trackEvent("pauseStart");break;case S.AdEnd:this.trackEvent("adComplete");break;case S.AdBreakEnd:this.trackEvent("adBreakComplete");break;case S.ContentStart:this.hasAdobeSession||this.requestAdobeSession(),this.trackEvent("play");break;case S.ContentPause:this.isStopped=!0,this.trackEvent("pauseStart"),this.pauseHbTracking();break;case S.BufferStart:this.isStopped=!0,this.trackEvent("bufferStart"),this.pauseHbTracking();break;case S.SeekStart:this.isStopped=!0,this.pauseHbTracking();break;case S.ContentResume:case S.PlayheadUpdate:this.isStopped&&(this.isStopped=!1,this.trackEvent("play"));break;case S.SessionEnd:this.trackSessionEnd()}},t.prototype.trackEvent=function(t){this.eventQueue.add(t),this.processEventQueue()},t.prototype.processEventQueue=function(){var e=this;this.hasAdobeSession&&this.eventQueue.forEach(function(t){e.sendTrackRequest(t)})},t.prototype.sendTrackRequest=function(t){var e=this,n={path:this.apiPath,data:this.vo.getPayload(t),method:"POST"};this.isDebug()&&this.logger.log(this.config.name,t,n),this.restClient.request(n).then(function(t){e.isDebug()&&e.logger.log(e.config.name,"statusCode",t.statusCode)}),"play"!==t||this.isAdPlaying||this.startHbTracking()},t.prototype.requestAdobeSession=function(){var n=this,t={path:P.SESSION_PATH,data:this.vo.getSessionStartData(),method:"POST"};this.isDebug()&&this.logger.log(this.config.name,t),this.restClient.request(t).then(function(t){if(404===t.statusCode)throw"Error: Server response 404";var e=t.xmlHttpRequest.getResponseHeader("location");if(!e)throw"Error: Location not found";n.hasAdobeSession=!0,n.apiPath=n.vo.getApiPath(e),n.isDebug()&&n.logger.log(n.config.name,n.apiPath),n.processEventQueue()})},t.prototype.startHbTracking=function(){var t=this;this.hasAdobeSession&&(this.isDebug()&&this.logger.log(this.config.name,"hbInterval",this.vo.hbInterval),this.timer.start(function(){t.trackEvent("ping")}))},t.prototype.pauseHbTracking=function(){this.isDebug()&&this.logger.log(this.config.name,"hb paused"),this.timer.stop()},t.prototype.trackSessionEnd=function(){this.pauseHbTracking(),this.hasContentCompleted()&&this.trackEvent("sessionComplete"),this.trackEvent("sessionEnd")},t.NAME="Adobe",t=a([h()],t)}(E);n.AdobeAgent=A;var P=function(n){function t(t){var e=n.call(this,t.config.params)||this;return e.agent=t,e}return o(t,n),t.prototype.getSessionStartData=function(){var t=this.agent.getData(),e=this.getPayload("sessionStart"),n=this.getVisitorData();return e.params={"analytics.trackingServer":this.trackingServer,"analytics.reportSuite":this.reportSuite,"analytics.visitorId":n.visitorId,"analytics.enableSSL":this.enableSSL,"visitor.marketingCloudOrgId":this.marketingCloudOrgId,"visitor.marketingCloudUserId":n.marketingCloudUserId,"media.playerName":t.playerName,"media.contentType":t.isLive?"Live":"VOD","media.length":t.duration,"media.id":t.mediaId,"media.name":t.videoTitle,"media.channel":this.channel,"media.sdkVersion":t.playerVersion,"media.show":t.seriesTitle,"media.season":t.season.toString(),"media.episode":t.episode.toString(),"media.genre":t.category,"media.network":this.channel,"media.showType":t.episodeFlag?"0":"2","media.resume":!!t.hasSessionResumed},t.contextData.mediaResume=t.hasSessionResumed?"true":"false",e.customMetadata=t.contextData,e},t.prototype.getVisitorData=function(){var t={visitorId:"",marketingCloudUserId:""},e=f.getVar("Visitor");if(!e)return t;var n=e.getInstance(this.marketingCloudOrgId,this.visitorOptions||{});return t.visitorId=n.getAnalyticsVisitorID(),t.marketingCloudUserId=n.getMarketingCloudVisitorID(),t},t.prototype.getAdBreakStartData=function(){var t=this.agent.getData();return{"media.ad.podFriendlyName":t.adBreakType,"media.ad.podIndex":t.adBreakPosition,"media.ad.podSecond":t.playhead}},t.prototype.getAdItemData=function(){var t=this.agent.getData();return{"media.ad.name":t.adTitle,"media.ad.id":t.videoTitle+" - "+t.adTitle,"media.ad.length":t.adDuration,"media.ad.creativeId":t.adId,"media.ad.creativeURL":t.adUrl,"media.ad.playerName":t.playerName,"media.ad.podPosition":t.adPosition}},t.prototype.getApiPath=function(t){return[t=t.replace(/^\/|\/$/g,""),"events"].join("/")},t.prototype.getPayload=function(t){var e=this.agent.getData(),n={};switch(t){case"adBreakStart":n=this.getAdBreakStartData();break;case"adStart":n=this.getAdItemData()}return{eventType:t,playerTime:{playhead:e.playhead,ts:(new Date).getTime()},params:n}},t.SESSION_PATH="api/v1/sessions",a([r(!1)],t.prototype,"enableSSL",void 0),a([r()],t.prototype,"channel",void 0),a([r()],t.prototype,"reportSuite",void 0),a([r()],t.prototype,"trackingServer",void 0),a([r()],t.prototype,"marketingCloudOrgId",void 0),a([r()],t.prototype,"marketingCloudUserId",void 0),a([r()],t.prototype,"devApiServer",void 0),a([r()],t.prototype,"prodApiServer",void 0),a([r(1e4)],t.prototype,"hbInterval",void 0),a([r()],t.prototype,"visitorOptions",void 0),t=a([h()],t)}(s);n.AdobeVo=P;var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasMonitor=!1,t.isAdPaused=!1,t}return o(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.vo=new L(this)},t.prototype.onNotificationReceived=function(t){switch(e.prototype.onNotificationReceived.call(this,t),t.name){case S.ContentStart:this.hasMonitor&&this.trackEvent("videochange"),this.startMuxMonitor();break;case S.DashJsLoaded:this.onDashJsLoaded();break;case S.HlsJsLoaded:this.onHlsJsLoaded();break;case S.AdLoaded:this.trackAdEvent("adplay");break;case S.AdStart:this.trackAdEvent("adplaying");break;case S.AdClick:case S.AdPause:this.isAdPaused=!0,this.trackAdEvent("adpause");break;case S.PlayheadUpdate:case S.AdResume:this.isAdPaused&&(this.isAdPaused=!1,this.trackAdEvent("adplay"),this.trackAdEvent("adplaying"));break;case S.AdSkip:case S.AdEnd:this.trackAdEvent("adended");break;case S.AdBreakStart:case S.AdError:case S.AdBreakEnd:this.trackAdEvent(t.name.toLowerCase());break;case S.PlayerError:this.onPlayerError()}},t.prototype.trackEvent=function(t){this.startMuxMonitor()&&this.mux.emit(this.vo.getVideoElement(),t,this.vo.getMuxMetadata())},t.prototype.trackAdEvent=function(t){this.startMuxMonitor()&&this.mux.emit(this.vo.getVideoElement(),t,this.vo.getAdData())},t.prototype.startMuxMonitor=function(){return this.isSdkLoaded?this.vo.getVideoElement()?(this.hasMonitor||(this.mux.monitor(this.vo.getVideoElement(),this.vo.getMuxOptions()),this.hasMonitor=!0),this.hasMonitor):(this.isDebug()&&this.logger.warn("videoElement missing"),!1):(this.isDebug()&&this.logger.warn("Sdk not loaded"),!1)},t.prototype.onDashJsLoaded=function(){var t=this.vo.getDashJsPlayer();t&&this.startMuxMonitor()&&this.mux.addDashJS({dashjs:t})},t.prototype.onHlsJsLoaded=function(){var t=this.vo.getHlsJsPlayer(),e=f.getVar("Hls");t&&e&&this.startMuxMonitor()&&this.mux.addHLSJS({hlsjs:t,Hls:e})},t.prototype.onPlayerError=function(){this.vo.isFatalError()&&this.startMuxMonitor()&&this.mux.emit(this.getData().videoElement,"error",this.vo.getErrorInfo())},t.prototype.onBeforeDestroy=function(){this.hasMonitor&&(this.mux.removeDashJS(),this.mux.removeHLSJS(),this.mux.destroyMonitor(this.vo.getVideoElement()))},t.NAME="Mux",t=a([d({src:"//src.litix.io/core/2/mux.js",name:"mux",type:"function"}),h()],t)}(E);n.MuxAgent=T;var L=function(n){function t(t){var e=n.call(this,t.config.params)||this;return e.agent=t,e}return o(t,n),t.prototype.getVideoElement=function(){return this.agent.getData().videoElement},t.prototype.getMuxOptions=function(){return{debug:this.agent.isDebug(),data:this.getMuxMetadata()}},t.prototype.getMuxMetadata=function(){var t=this.agent.getData();return{env_key:this.envKey,page_type:"",viewer_user_id:t.userId,experiment_name:this.experimentName,sub_property_id:this.subPropertyId,player_name:t.playerName,player_version:t.playerVersion,player_init_time:t.playerInitTime,video_id:t.mediaId,video_title:t.videoTitle,video_series:t.seriesTitle,video_producer:"",video_content_type:t.episodeFlag?"episode":"clip",video_language_code:"",video_variant_name:"",video_variant_id:"",video_duration:t.duration,video_stream_type:t.isLive?"live":"on-demand",video_encoding_variant:"",video_cdn:t.cdn}},t.prototype.getAdData=function(){var t=this.agent.getData();return{ad_tag_url:t.adUrl,ad_asset_url:t.adUrl}},t.prototype.getErrorInfo=function(){var t=this.agent.getData();return{player_error_code:t.errorType,player_error_message:t.errorMessage}},t.prototype.getDashJsPlayer=function(){return this.agent.getData().dashJsPlayer},t.prototype.getHlsJsPlayer=function(){return this.agent.getData().hlsJsPlayer},t.prototype.isFatalError=function(){return this.agent.getData().errorFatal},a([r("ec83cce4c209447a2af3d62f2")],t.prototype,"envKey",void 0),a([r()],t.prototype,"experimentName",void 0),a([r()],t.prototype,"subPropertyId",void 0),t=a([h()],t)}(s);n.MuxVo=L;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasContentStart=!1,t}return o(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.vo=new M(this)},t.prototype.onNotificationReceived=function(t){switch(e.prototype.onNotificationReceived.call(this,t),t.name){case S.SessionStart:this.createStreamingTag();break;case S.AdStart:case S.AdResume:this.trackAdPlay();break;case S.ContentStart:case S.ContentResume:this.trackContentPlay();break;case S.LiveSegmentStart:this.trackStop(),this.vo.isSameLiveStation()||this.createStreamingTag(),this.trackContentPlay();break;case S.AdClick:case S.AdEnd:case S.AdPause:case S.ContentEnd:case S.ContentPause:case S.LiveSegmentEnd:this.trackStop()}},t.prototype.createStreamingTag=function(){this.streamingTag=new this.ns_.ReducedRequirementsStreamingAnalytics(this.vo.getComscoreConfig())},t.prototype.trackAdPlay=function(){this.streamingTag&&this.streamingTag.playVideoAdvertisement(this.vo.getAdMetadata(),this.vo.getAdType())},t.prototype.trackContentPlay=function(){this.streamingTag&&this.streamingTag.playVideoContentPart(this.vo.getContentMetadata(),this.vo.getContentType())},t.prototype.trackStop=function(){this.streamingTag&&this.streamingTag.stop()},t.NAME="Comscore",t=a([d({src:"sdk/comscore.js",name:"ns_",type:"object"}),h()],t)}(E);n.ComscoreAgent=R;var M=function(n){function t(t){var e=n.call(this,t.config.params)||this;return e.agent=t,e}var d;return o(t,n),(d=t).prototype.getComscoreConfig=function(){return{publisherId:this.c2,ns_st_pu:this.partnerID||this.agent.getData().partner}},t.prototype.getAdMetadata=function(){return{ns_st_cl:this.agent.getData().adDuration}},t.prototype.getAdType=function(){var t=this.agent.getData(),e=this.agent.ns_.ReducedRequirementsStreamingAnalytics.AdType,n=t.adId.split("_")[0];return t.isLive?e.LinearLive:"pre"===n?e.LinearOnDemandPreRoll:"mid"===n?e.LinearOnDemandMidRoll:e.LinearOnDemandPostRoll},t.prototype.getContentMetadata=function(){var t=this.agent.getData(),e=t.videoTitle.split("-"),n=0<e.length?e[1]:t.videoTitle,i=d.NULL,o=d.NULL,a=t.videoTitle,r=t.contextData.comscore_c4||"";isNaN(t.season)||isNaN(t.episode)||(a+="--"+(i=this.padSingleDigitWithZero(t.season))+(o=this.padSingleDigitWithZero(t.episode)));var s={ns_st_ci:t.mediaId,ns_st_cl:t.duration,ns_st_pu:this.partnerID,ns_st_pr:t.seriesTitle||t.videoTitle,ns_st_ep:n,ns_st_sn:i,ns_st_en:o,ns_st_ge:t.category||d.NULL,ns_st_ia:t.isLive?1:0,ns_st_ddt:d.NULL,ns_st_tdt:d.NULL,ns_st_st:this.c4||d.NULL,ns_st_ce:t.episodeFlag?1:0,c3:t.playerName,c4:r||this.c4,c6:this.c6||a};return t.isLive&&(s=this.mergeLiveSegmentData(s)),s},t.prototype.getContentType=function(){var t=this.agent.ns_.ReducedRequirementsStreamingAnalytics.ContentType;return this.agent.getData().isLive?t.Live:t.LongFormOnDemand},t.prototype.mergeLiveSegmentData=function(e){var n=this.agent.getData().liveSegmentData;return Object.keys({publisherBrand:"ns_st_pu",programTitle:"ns_st_pr",episodeTitle:"ns_st_ep",seasonNumber:"ns_st_sn",episodeNumber:"ns_st_en",stationTitle:"ns_st_st",clipLength:"ns_st_cl",contentGenre:"ns_st_ge",tmsGracenoteId:"ns_st_ti",episodeId:"ns_st_tep",adLoadFlag:"ns_st_ia",fullEpisodeFlag:"ns_st_ce",digitalAirDate:"ns_st_ddt",tvAirDate:"ns_st_tdt"}).forEach(function(t){n.hasOwnProperty(t)&&n[t]&&(e[t]=n[t])}),e},t.prototype.isSameLiveStation=function(){var t=this.agent.getData().liveSegmentData,e=this.c4||d.NULL;return t.stationTitle&&t.stationTitle===e},t.prototype.padSingleDigitWithZero=function(t){return(0<t&&t<10?"0":"")+t.toString()},t.NULL="*null",a([r("3005086")],t.prototype,"c2",void 0),a([r()],t.prototype,"c3",void 0),a([r()],t.prototype,"c4",void 0),a([r()],t.prototype,"c6",void 0),a([r()],t.prototype,"partnerID",void 0),a([r()],t.prototype,"publishersSecret",void 0),t=d=a([h()],t)}(s);n.ComscoreVo=M},{}]},{},[1])(1)});