!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;((e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).vtg||(e.vtg={})).tracking=t()}}(function(){return function o(a,s,u){function d(e,t){if(!s[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(p)return p(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[e]={exports:{}};a[e][0].call(r.exports,function(t){return d(a[e][1][t]||t)},r,r.exports,o,a,s,u)}return s[e].exports}for(var p="function"==typeof require&&require,t=0;t<u.length;t++)d(u[t]);return d}({1:[function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var r,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;0<=s;s--)(r=t[s])&&(a=(o<3?r(a):3<o?r(e,i,a):r(e,i))||a);return 3<o&&a&&Object.defineProperty(e,i,a),a};function a(i){return function(t,e){t.keys||(t.keys={}),t.keys[e]=function(t){return t.hasOwnProperty(e)&&t[e]?t[e]:"boolean"!=typeof i?i||"":i}}}Object.defineProperty(i,"__esModule",{value:!0}),i.ModuleParam=a;var s=function(){function t(t){this.data=t,this.format()}return t.prototype.format=function(){var e=this,i=this;return Object.keys(this.keys).forEach(function(t){i[t]=e.keys[t](e.data)}),i},t}();function u(){return function(t){t.prototype.destroy=function(){var e=this;"function"==typeof this.onBeforeDestroy&&this.onBeforeDestroy(),Object.keys(this).forEach(function(t){"function"!=typeof e[t]&&(e[t]=null)})}}}i.DataAccess=s,i.Destroyable=u,i.Injectable=function(e){return function(t){t.prototype.injectable=e}};var d=function(){function e(){}return e.prototype.inject=function(t){return this.scriptSrc=t.src,this.isDefined=function(){return g.isVar(t.name,t.type)},this},e.prototype.then=function(t){this.isDefined()?t(e.LOADED):g.injectScript(this.scriptSrc,t)},e.ERROR="error",e.LOADED="loaded",e}();i.JsInjector=d;var p=function(){function t(){this.debug=!1}return t.getDefault=function(){return this.instance||(this.instance=new this)},t.prototype.setLogger=function(t){this.hasLogFunction(t)&&(this.logger=t)},t.prototype.getLogger=function(){return this.logger||this.setLogger(console),this.logger},t.prototype.hasLogFunction=function(t){return"object"==typeof t&&"function"==typeof t.log},t}();i.Log=p;var c=function(){function t(){this.observers=[]}return t.prototype.register=function(t){"object"==typeof t&&(this.observers.unshift(t),t.onRegister())},t.prototype.deregister=function(e){this.observers=this.observers.filter(function(t){return t!==e})},t.prototype.notify=function(t){for(var e=this.observers.length;e--;){var i=this.observers[e];i.onNotify.call(i,t)}},t}();i.Observable=c;var h=function(){function t(){this.items=[],this.isRunning=!1}return t.prototype.add=function(t){this.items.unshift(t)},t.prototype.forEach=function(t){if(!this.isRunning){this.isRunning=!0;for(var e=this.items.length;e--;){var i=this.items.pop();i&&t(i)}this.isRunning=!1}},t.prototype.isEmpty=function(){return 0===this.items.length},t}();i.Queue=h;var f=function(){function t(t){this.baseUrl=t,this.baseUrl=t.replace(/^\w*:/,"").replace(/^\/\//,"").replace(/\/*$/,"")}return t.prototype.request=function(t){return this.options=t,this},t.prototype.then=function(t){switch(this.options.method){case"POST":this.post(t);break;case"GET":this.get(t)}},t.prototype.post=function(t){var e=new XMLHttpRequest,i=[this.baseUrl,this.options.path].join("/");e.open("POST","//"+i,!0),e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&t({xmlHttpRequest:e,statusCode:e.status,message:200<=e.status&&e.status<300||304===e.status?"ok":e.statusText})},e.onerror=function(){t({xmlHttpRequest:e,statusCode:e.status,message:"error"})},e.send(JSON.stringify(this.options.data))},t.prototype.get=function(i){var t=new XMLHttpRequest,e=[this.baseUrl,this.options.path].join("/"),n=function(t,e){i({xmlHttpRequest:t,statusCode:t.status,message:e})};t.open("GET","//"+e,!0),t.onload=function(){return n(t,"load")},t.onerror=function(){return n(t,"error")},t.onabort=function(){return n(t,"abort")},t.send(e+JSON.stringify(this.options.data))},t}();i.RestClient=f;var g,l=function(){function t(t){this.milliseconds=t,this.isRunning=!1}return t.prototype.start=function(t){this.isRunning||(this.intervalId=setInterval(t,this.milliseconds),this.isRunning=!0)},t.prototype.stop=function(){clearInterval(this.intervalId),this.isRunning=!1},t}();i.Timer=l,function(t){function n(){return"object"==typeof window}function e(){return"object"==typeof top}function i(t,e){var i=window.document.createElement("script");i.src=t,i.type="text/javascript",i.onload=function(){return e(d.LOADED)},i.onerror=function(){return e(d.ERROR)},document.getElementsByTagName("head")[0].appendChild(i)}t.isWindow=n,t.isTop=e,t.isVar=function(t,e){var i=t.split(".");return 2===i.length?n()&&typeof window[i[0]]===e&&typeof window[i[0]][i[1]]===e:n()&&typeof window[t]===e},t.getVar=function(t){return n()&&window[t]},t.getScreenSize=function(){var t=window;return n()&&t.screen&&t.screen.width&&t.screen.height?t.screen.width+"x"+t.screen.height:"N/A"},t.injectScript=function(t,e){n()&&i(t,e)},t.appendChildToHead=i,t.getProtocol=function(){return e()?-1<top.location.href.search(/^https/)?"https://":"http://":""}}(g=i.View||(i.View={}));var y=function(){function t(){this.metadata=new v}return t.getDefault=function(){return this.instance||(this.instance=new this)},t.prototype.update=function(t){this.metadata=Object.assign(this.metadata,t),this.metadata.timestamp=(new Date).getTime()},t.prototype.getData=function(){return this.metadata},t}();i.DataProxy=y;var v=function(){this.playerName="",this.playerVersion="",this.playerInitTime=-1,this.playerManager={},this.dashJsPlayer={},this.hlsJsPlayer={},this.videoElement={},this.isMobile=!1,this.hasSessionResumed=!1,this.sessionId="",this.adBreakType="",this.adBreakPosition=-1,this.adBreakDuration=-1,this.adTitle="",this.adId="",this.adUrl="",this.adDuration=-1,this.adPosition=-1,this.mediaUrl="",this.category="",this.mediaId="",this.episodeTitle="",this.seriesTitle="",this.videoTitle="",this.airDate="",this.duration=-1,this.episodeFlag=!1,this.isLive=!1,this.timestamp=-1,this.playhead=-1,this.season=-1,this.episode=-1,this.liveSegmentData={},this.cdn="",this.currentBitrate=-1,this.playbackFramerate=-1,this.drmEnabled=!1,this.drmType="",this.userId="",this.userStatus="anon",this.partner="",this.userCountry="",this.userConnectionType="",this.contextData={},this.ozTamMediaId="",this.ozTamOptOut=!1,this.nielsenOptOut=!1,this.errorType=-1,this.errorMessage="",this.errorFatal=!1};i.DataVo=v;var m,S,k,b=function(){function t(t){this.config=t,this.isAdPlaying=!1,this.hasSdk=!1}return t.prototype.onRegister=function(){this.isDebug()&&this.logger.log(this.config.name,"start up")},t.prototype.onSdkLoaded=function(){this.hasSdk=!0},t.prototype.onNotify=function(t){this.isDebug()&&this.logger.log(this.config.name,t),this.notification=t,this.checkForAdPlay()},t.prototype.checkForAdPlay=function(){switch(this.notification.name){case m.AdBreakStart:case m.AdStart:this.isAdPlaying=!0;break;case m.AdEnd:case m.AdBreakEnd:case m.ContentStart:this.isAdPlaying=!1}},t.prototype.hasContentCompleted=function(){var t=this.getData();return(!t||!t.isLive)&&t.playhead>=.95*t.duration},t.prototype.getData=function(){return y.getDefault().getData()},t.prototype.isDebug=function(){return p.getDefault().debug},Object.defineProperty(t.prototype,"logger",{get:function(){return p.getDefault().getLogger()},enumerable:!0,configurable:!0}),t}();i.Agent=b,(S=m=i.AppEvent||(i.AppEvent={})).AppClose="appClose",S.AdBreakEnd="adBreakEnd",S.AdBreakStart="adBreakStart",S.AdClick="adClick",S.AdEnd="adEnd",S.AdError="adError",S.AdFirstQuartile="adFirstQuartile",S.AdLoaded="adLoaded",S.AdMidPoint="adMidPoint",S.AdPause="adPause",S.AdRequest="adRequest",S.AdResponse="adResponse",S.AdResume="adResume",S.AdSkip="adSkip",S.AdStart="adStart",S.AdThirdQuartile="adThirdQuartile",S.BitrateChange="bitrateChange",S.BufferEnd="bufferEnd",S.BufferStart="bufferStart",S.ChapterEnd="chapterEnd",S.ChapterStart="chapterStart",S.ChapterSkip="chapterSkip",S.ContentEnd="contentEnd",S.ContentPause="contentPause",S.ContentResume="contentResume",S.ContentStart="contentStart",S.DashJsLoaded="dashJsLoaded",S.EnterForeground="EnterForeground",S.ExitForeground="ExitForeground",S.FirstQuartile="firstQuartile",S.HlsJsLoaded="hlsJsLoaded",S.LiveSegmentStart="LiveSegmentStart",S.LiveSegmentEnd="LiveSegmentEnd",S.MidQuartile="midQuartile",S.PlayerError="playerError",S.QosEvent="qosEvent",S.SeekEnd="seekEnd",S.SeekStart="seekStart",S.SessionEnd="sessionEnd",S.SessionStart="sessionStart",S.ThirdQuartile="thirdQuartile",S.PlayheadUpdate="playheadUpdate",(k=i.BuildInfo||(i.BuildInfo={})).applicationPlatform="Desktop",k.isChromecast=function(){return"Chromecast"===k.applicationPlatform},k.isSamsungTv=function(){return"SamsungTv"===k.applicationPlatform};var E=function(){function t(){}return t.prototype.registerAgents=function(t){var i=this;this.tracker=t,this.tracker.modules.forEach(function(t){if(i.isAgentEnabled(t.NAME)){var e=i.getAgentConfig(t.NAME);i.registerAgent(new t(e))}})},t.prototype.isAgentEnabled=function(t){return this.tracker.config.hasOwnProperty(t)&&this.tracker.config[t].hasOwnProperty("enabled")&&this.tracker.config[t].enabled},t.prototype.getAgentConfig=function(t){var e=this.tracker.config[t];return e.name=t,e},t.prototype.registerAgent=function(e){if(this.tracker.register(e),"object"==typeof e.injectable){var t=e.injectable;(new d).inject(t).then(function(t){t===d.LOADED&&e.onSdkLoaded()})}},t}();i.Registrar=E;var D=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t.registrar=new E,t.modules=[A],t.version="tracking v0.1.2 Thu, 30 May 2019 20:27:59 GMT",t}return r(t,i),t.prototype.track=function(t,e){this.isDebug()&&this.logger().log("[Tracker] "+t,e),y.getDefault().update(e),i.prototype.notify.call(this,{name:t,body:e})},t.prototype.setConfig=function(t){this.config=t,this.registrar.registerAgents(this)},t.prototype.setContextData=function(t){y.getDefault().update({contextData:t})},t.prototype.setLiveSegmentData=function(t){y.getDefault().update({liveSegmentData:t})},t.prototype.setDebug=function(t){p.getDefault().debug=t},t.prototype.setLogger=function(t){p.getDefault().setLogger(t)},t.prototype.isDebug=function(){return p.getDefault().debug},t.prototype.logger=function(){return p.getDefault().getLogger()},t}(c);i.Tracker=D;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasAdobeSession=!1,t.isStopped=!1,t.hasSdk=!0,t}return r(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.vo=new C(this),this.restClient=new f(this.isDebug()?this.vo.devApiServer:this.vo.prodApiServer),this.eventQueue=new h,this.timer=new l(this.vo.hbInterval)},t.prototype.onNotify=function(t){switch(e.prototype.onNotify.call(this,t),t.name){case m.AdBreakStart:this.pauseHbTracking(),this.trackEvent("adBreakStart");break;case m.AdStart:this.trackEvent("adStart");break;case m.AdClick:case m.AdPause:this.trackEvent("pauseStart");break;case m.AdEnd:this.trackEvent("adComplete");break;case m.AdBreakEnd:this.trackEvent("adBreakComplete");break;case m.ContentStart:this.hasAdobeSession||this.requestAdobeSession(),this.trackEvent("play");break;case m.ContentPause:this.isStopped=!0,this.trackEvent("pauseStart"),this.pauseHbTracking();break;case m.BufferStart:this.isStopped=!0,this.trackEvent("bufferStart"),this.pauseHbTracking();break;case m.SeekStart:this.isStopped=!0,this.pauseHbTracking();break;case m.ContentResume:case m.PlayheadUpdate:this.isStopped&&(this.isStopped=!1,this.trackEvent("play"));break;case m.SessionEnd:this.trackSessionEnd()}},t.prototype.trackEvent=function(t){this.eventQueue.add(t),this.processEventQueue()},t.prototype.processEventQueue=function(){var e=this;this.hasAdobeSession&&this.eventQueue.forEach(function(t){e.sendTrackRequest(t)})},t.prototype.sendTrackRequest=function(t){var e=this,i={path:this.apiPath,data:this.vo.getPayload(t),method:"POST"};this.isDebug()&&this.logger.log(this.config.name,t,i),this.restClient.request(i).then(function(t){e.isDebug()&&e.logger.log(e.config.name,"statusCode",t.statusCode)}),"play"!==t||this.isAdPlaying||this.startHbTracking()},t.prototype.requestAdobeSession=function(){var i=this,t={path:C.SESSION_PATH,data:this.vo.getSessionStartData(),method:"POST"};this.isDebug()&&this.logger.log(this.config.name,t),this.restClient.request(t).then(function(t){if(404===t.statusCode)throw"Error: Server response 404";var e=t.xmlHttpRequest.getResponseHeader("location");if(!e)throw"Error: Location not found";i.hasAdobeSession=!0,i.apiPath=i.vo.getApiPath(e),i.isDebug()&&i.logger.log(i.config.name,i.apiPath),i.processEventQueue()})},t.prototype.startHbTracking=function(){var t=this;this.hasAdobeSession&&(this.isDebug()&&this.logger.log(this.config.name,"hbInterval",this.vo.hbInterval),this.timer.start(function(){t.trackEvent("ping")}))},t.prototype.pauseHbTracking=function(){this.isDebug()&&this.logger.log(this.config.name,"hb paused"),this.timer.stop()},t.prototype.trackSessionEnd=function(){this.pauseHbTracking(),this.hasContentCompleted()&&this.trackEvent("sessionComplete"),this.trackEvent("sessionEnd")},t.NAME="Adobe",t=o([u()],t)}(b);i.AdobeAgent=A;var C=function(i){function t(t){var e=i.call(this,t.config.params)||this;return e.agent=t,e}return r(t,i),t.prototype.getSessionStartData=function(){var t=this.agent.getData(),e=this.getPayload("sessionStart"),i=this.getVisitorData();return e.params={"analytics.trackingServer":this.trackingServer,"analytics.reportSuite":this.reportSuite,"analytics.visitorId":i.visitorId,"analytics.enableSSL":this.enableSSL,"visitor.marketingCloudOrgId":this.marketingCloudOrgId,"visitor.marketingCloudUserId":i.marketingCloudUserId,"media.playerName":t.playerName,"media.contentType":t.isLive?"Live":"VOD","media.length":t.duration,"media.id":t.mediaId,"media.name":t.videoTitle,"media.channel":this.channel,"media.sdkVersion":t.playerVersion,"media.show":t.seriesTitle,"media.season":t.season.toString(),"media.episode":t.episode.toString(),"media.genre":t.category,"media.network":this.channel,"media.showType":t.episodeFlag?"0":"2","media.resume":!!t.hasSessionResumed},t.contextData.mediaResume=t.hasSessionResumed?"true":"false",e.customMetadata=t.contextData,e},t.prototype.getVisitorData=function(){var t={visitorId:"",marketingCloudUserId:""},e=g.getVar("Visitor");if(!e)return t;var i=e.getInstance(this.marketingCloudOrgId,this.visitorOptions||{});return t.visitorId=i.getAnalyticsVisitorID(),t.marketingCloudUserId=i.getMarketingCloudVisitorID(),t},t.prototype.getAdBreakStartData=function(){var t=this.agent.getData();return{"media.ad.podFriendlyName":t.adBreakType,"media.ad.podIndex":t.adBreakPosition,"media.ad.podSecond":t.playhead}},t.prototype.getAdItemData=function(){var t=this.agent.getData();return{"media.ad.name":t.adTitle,"media.ad.id":t.videoTitle+" - "+t.adTitle,"media.ad.length":t.adDuration,"media.ad.creativeId":t.adId,"media.ad.creativeURL":t.adUrl,"media.ad.playerName":t.playerName,"media.ad.podPosition":t.adPosition}},t.prototype.getApiPath=function(t){return[t=t.replace(/^\/|\/$/g,""),"events"].join("/")},t.prototype.getPayload=function(t){var e=this.agent.getData(),i={};switch(t){case"adBreakStart":i=this.getAdBreakStartData();break;case"adStart":i=this.getAdItemData()}return{eventType:t,playerTime:{playhead:e.playhead,ts:(new Date).getTime()},params:i}},t.SESSION_PATH="api/v1/sessions",o([a(!1)],t.prototype,"enableSSL",void 0),o([a()],t.prototype,"channel",void 0),o([a()],t.prototype,"reportSuite",void 0),o([a()],t.prototype,"trackingServer",void 0),o([a()],t.prototype,"marketingCloudOrgId",void 0),o([a()],t.prototype,"marketingCloudUserId",void 0),o([a()],t.prototype,"devApiServer",void 0),o([a()],t.prototype,"prodApiServer",void 0),o([a(1e4)],t.prototype,"hbInterval",void 0),o([a()],t.prototype,"visitorOptions",void 0),t=o([u()],t)}(s);i.AdobeVo=C},{}]},{},[1])(1)});